name: Code - Branches
permissions:
  contents: write
  pull-requests: write
  security-events: write

on:
  push:
    branches-ignore:
      - "main"
    paths:
      - "src/**"
      - "build/**"
      - ".github/workflows/code-*.yml"
      - ".github/workflows/zz-build-*.yml"
      - ".github/workflows/zz-release-*.yml"

jobs:
  inspections:
    name: Inspections
    uses: ./.github/workflows/zz-inspections.yml
    secrets: inherit

  build-hub:
    name: Build - Hub
    uses: ./.github/workflows/zz-build-hub.yml
    secrets: inherit

  build-cli:
    name: Build - CLI
    uses: ./.github/workflows/zz-build-cli.yml
    secrets: inherit

  actions-timeline:
    name: Timeline
    needs: [inspections, build-hub, build-cli]
    runs-on: ubuntu-latest
    steps:
      - uses: Kesin11/actions-timeline@v2
        with:
          show-waiting-runner: true
